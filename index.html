<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØµÙˆØ± Google - Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„</title>
    
    <!-- Bootstrap & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Google Identity Services (Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹) -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    
    <style>
        /* Ø£Ù†Ù…Ø§Ø· Ø³Ø±ÙŠØ¹Ø© Ù„Ù„ØªØ¬Ø±Ø¨Ø© */
        body {
            background: linear-gradient(135deg, #1a73e8, #34a853);
            min-height: 100vh;
            font-family: 'Segoe UI', sans-serif;
        }
        
        .login-card {
            background: white;
            border-radius: 28px;
            padding: 40px;
            max-width: 400px;
            margin: 100px auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .google-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            width: 100%;
            padding: 12px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 40px;
            font-size: 16px;
            cursor: pointer;
            margin: 20px 0;
        }
        
        .user-info {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin: 20px;
        }
    </style>
</head>
<body>
    <!-- Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="loginScreen">
        <div class="login-card">
            <h2 class="text-center mb-4">ðŸ“¸ ØµÙˆØ± Google</h2>
            <p class="text-center text-muted mb-4">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„ØµÙˆØ±</p>
            
            <!-- Ø²Ø± Google Ø§Ù„Ø±Ø³Ù…ÙŠ -->
            <div id="g_id_onload"
                 data-client_id="919384082772-uoofli82smlvhc2oeiu2uctnrc7iumg2.apps.googleusercontent.com"
                 data-context="signin"
                 data-ux_mode="popup"
                 data-callback="handleCredentialResponse"
                 data-auto_prompt="false">
            </div>
            
            <div class="g_id_signin"
                 data-type="standard"
                 data-shape="rectangular"
                 data-theme="outline"
                 data-text="signin_with"
                 data-size="large"
                 data-logo_alignment="left">
            </div>
            
            <div class="google-btn" onclick="document.querySelector('.g_id_signin').click()">
                <img src="https://www.google.com/favicon.ico" width="20">
                <span>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø­Ø³Ø§Ø¨ Google</span>
            </div>
        </div>
    </div>
    
    <!-- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ù…Ø®ÙÙŠ ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©) -->
    <div id="mainApp" style="display: none;">
        <div class="user-info" id="userInfo">
            <h3>Ù…Ø±Ø­Ø¨Ø§Ù‹! <span id="userName"></span></h3>
            <p>Ø§Ù„Ø¨Ø±ÙŠØ¯: <span id="userEmail"></span></p>
            <img id="userPicture" src="" style="width: 50px; height: 50px; border-radius: 50%;">
            <button class="btn btn-danger mt-3" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>
    </div>

    <script>
        // ================ Client ID Ø§Ù„ØµØ­ÙŠØ­ ================
        const CLIENT_ID = '919384082772-uoofli82smlvhc2oeiu2uctnrc7iumg2.apps.googleusercontent.com';
        
        // ================ Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ================
        function handleCredentialResponse(response) {
            console.log('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!', response);
            
            // ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const data = parseJwt(response.credential);
            
            // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            document.getElementById('userName').textContent = data.name;
            document.getElementById('userEmail').textContent = data.email;
            document.getElementById('userPicture').src = data.picture;
            
            // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            localStorage.setItem('user', JSON.stringify(data));
            
            alert(`Ù…Ø±Ø­Ø¨Ø§Ù‹ ${data.name}! ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­`);
        }
        
        // ================ ÙÙƒ ØªØ´ÙÙŠØ± JWT Token ================
        function parseJwt(token) {
            const base64Url = token.split('.')[1];
            const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            return JSON.parse(jsonPayload);
        }
        
        // ================ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ================
        function logout() {
            // Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            localStorage.removeItem('user');
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'block';
            
            alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬');
        }
        
        // ================ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ø³Ø§Ø¨Ù‚ ================
        document.addEventListener('DOMContentLoaded', () => {
            const savedUser = localStorage.getItem('user');
            if (savedUser) {
                const user = JSON.parse(savedUser);
                document.getElementById('userName').textContent = user.name;
                document.getElementById('userEmail').textContent = user.email;
                document.getElementById('userPicture').src = user.picture;
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
            }
        });
    </script>
</body>
</html>
